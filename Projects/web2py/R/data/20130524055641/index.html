<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<title>6.3.&nbsp;Using Individual Components</title>

<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="http://www.debian.org/releases/stable/i386/index.html.en" title="Debian GNU/Linux Installation Guide">
<link rel="up" href="http://www.debian.org/releases/stable/i386/ch06.html.en" title="Chapter&nbsp;6.&nbsp;Using the Debian Installer">
<link rel="prev" href="http://www.debian.org/releases/stable/i386/ch06s02.html.en" title="6.2.&nbsp;Components Introduction">
<link rel="next" href="http://www.debian.org/releases/stable/i386/ch06s04.html.en" title="6.4.&nbsp;Loading Missing Firmware">

<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body link="#0000FF" text="black" vlink="#840084" bgcolor="white" alink="#0000FF">
<div class="navheader">
<table summary="Navigation header" width="100%">
<tbody><tr><th colspan="3" align="center">6.3.&nbsp;Using Individual Components</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="http://www.debian.org/releases/stable/i386/ch06s02.html.en">Prev</a>&nbsp;</td>
<th width="60%" align="center">Chapter&nbsp;6.&nbsp;Using the Debian Installer</th>
<td width="20%" align="right">&nbsp;<a accesskey="n" href="http://www.debian.org/releases/stable/i386/ch06s04.html.en">Next</a>
</td>
</tr>
</tbody></table>
<hr>
</div>
<div class="sect1" title="6.3.&nbsp;Using Individual Components">
<div class="titlepage"><div><div><h2 class="title" style="clear: both;">
<a name="module-details"></a>6.3.&nbsp;Using Individual Components</h2></div></div></div>
<p>

In this section we will describe each installer component in
detail. The components have been grouped into stages that should
be recognizable for users. They are presented in the order they
appear during the install. Note that not all modules will be used
for every installation; which modules are actually used depends on
the installation method you use and on your hardware.

</p>
<div class="sect2" title="6.3.1.&nbsp;Setting up Debian Installer and Hardware Configuration">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-setup"></a>6.3.1.&nbsp;Setting up Debian Installer and Hardware Configuration</h3></div></div></div>
<p>

Let's assume the Debian Installer has booted and you are facing its
first screen.  At this time, the capabilities of <code class="classname">debian-installer</code> are still quite
limited. It doesn't know much about your hardware, preferred language,
or even the task it should perform. Don't worry. Because <code class="classname">debian-installer</code> is quite
clever, it can automatically probe your hardware, locate the rest
of its components and upgrade itself to a capable installation system.

However, you still need to help <code class="classname">debian-installer</code> with some information it can't
determine automatically (like selecting your preferred language, keyboard
layout or desired network mirror).

</p>
<p>

You will notice that <code class="classname">debian-installer</code> performs <em class="firstterm">hardware detection</em>
several times during this stage. The first time is targeted specifically
at the hardware needed to load installer components (e.g. your CD-ROM or
network card). As not all drivers may be available during this first run,
hardware detection needs to be repeated later in the process.

</p>
<p>

During hardware detection <code class="classname">debian-installer</code> checks if any of the drivers for the
hardware devices in your system require firmware to be loaded. If any
firmware is requested but unavailable, a dialog will be displayed that
allows the missing firmware to be loaded from a removable medium.
See <a class="xref" href="http://www.debian.org/releases/stable/i386/ch06s04.html.en" title="6.4.&nbsp;Loading Missing Firmware">Section&nbsp;6.4, “Loading Missing Firmware”</a> for further details.

</p>
<div class="sect3" title="6.3.1.1.&nbsp;Check available memory / low memory mode">
<div class="titlepage"><div><div><h4 class="title">
<a name="lowmem"></a>6.3.1.1.&nbsp;Check available memory / low memory mode</h4></div></div></div>
<p>

One of the first things <code class="classname">debian-installer</code> does, is to check available memory.
If the available memory is limited, this component will make some
changes in the installation process which hopefully will allow
you to install Debian GNU/Linux on your system.

</p>
<p>

The first measure taken to reduce memory consumption by the installer
is to disable translations, which means that the installation can
only be done in English. Of course, you can still localize the installed
system after the installation has completed.

</p>
<p>

If that is not sufficient, the installer will further reduce memory
consumption by loading only those components essential to complete a basic
installation. This reduces the functionality of the installation system.
You will be given the opportunity to load additional components manually,
but you should be aware that each component you select will use
additional memory and thus may cause the installation to fail.

</p>
<p>

If the installer runs in low memory mode, it is recommended to create
a relatively large swap partition (64–128MB). The swap partition
will be used as virtual memory and thus increases the amount of memory
available to the system. The installer will activate the swap partition
as early as possible in the installation process. Note that heavy use
of swap will reduce performance of your system and may lead to high
disk activity.

</p>
<p>

Despite these measures, it is still possible that your system freezes,
that unexpected errors occur or that processes are killed by the kernel
because the system runs out of memory (which will result in <span class="quote">“<span class="quote">Out
of memory</span>”</span> messages on VT4 and in the syslog).

</p>
<p>

For example, it has been reported that creating a big ext3 file system
fails in low memory mode when there is insufficient swap space. If a
larger swap doesn't help, try creating the file system as ext2 (which
is an essential component of the installer) instead. It is possible to
change an ext2 partition to ext3 after the installation.

</p>
<p>

It is possible to force the installer to use a higher lowmem level than
the one based on available memory by using the boot parameter
<span class="quote">“<span class="quote">lowmem</span>”</span> as described in <a class="xref" href="http://www.debian.org/releases/stable/i386/ch05s03.html.en#installer-args" title="5.3.2.&nbsp;Debian Installer Parameters">Section&nbsp;5.3.2, “Debian Installer Parameters”</a>.

</p>
</div>
<div class="sect3" title="6.3.1.2.&nbsp;Selecting Localization Options">
<div class="titlepage"><div><div><h4 class="title">
<a name="localechooser"></a>6.3.1.2.&nbsp;Selecting Localization Options</h4></div></div></div>
<p>

In most cases the first questions you will be asked concern the selection
of localization options to be used both for the installation and for the
installed system. The localization options consist of language, location
and locales.

</p>
<p>

The language you choose will be used for the rest of the installation
process, provided a translation of the different dialogs is available.
If no valid translation is available for the selected language, the
installer will default to English.

</p>
<p>

The selected geographic location (in most cases a country) will be used
later in the installation process to select the correct time zone and a
Debian mirror appropriate for that country.
Language and country together will help determine the default locale for
your system and select the correct keyboard layout.

</p>
<p>

You will first be asked to select your preferred language. The language
names are listed both in English (left side) and in the language itself
(right side); the names on the right side are also shown in the proper
script for the language. The list is sorted on the English names.
At the top of the list is an extra option that allows you to select the
<span class="quote">“<span class="quote">C</span>”</span> locale instead of a language. Choosing the <span class="quote">“<span class="quote">C</span>”</span>
locale will result in the installation proceding in English; the installed
system will have no localization support as the <code class="classname">locales</code>
package will not be installed.

</p>
<p>

Next you will be asked to select your geographic location. If you selected
a language that is recognized as an official language for more than one
country<sup>[<a name="idp6408368" href="#ftn.idp6408368" class="footnote">8</a>]</sup>, you will be shown a list of only those countries. To select a
country that is not in that list, choose <span class="guimenuitem">other</span>
(the last option). You will then be presented with a list of continents;
selecting a continent will lead to a list of relevant countries on that
continent.

</p>
<p>

If the language has only one country associated with it, a list of countries
will be displayed for the continent or region the country belongs to, with
that country selected as the default. Use the <span class="guibutton">Go Back</span>
option to select countries on a different continent.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

It is important to select the country where you live or where you are
located as it determines the time zone that will be configured for the
installed system.

</p>
</div>
<p>

If you selected a combination of language and country for which no locale is
defined and there exist multiple locales for the language, then the installer
will allow you to choose which of those locales you prefer as the default
locale for the installed system<sup>[<a name="idp6412368" href="#ftn.idp6412368" class="footnote">9</a>]</sup>. In all other cases a default locale will be selected based on
the selected language and country.

</p>
<p>

Any default locale selected as described in the previous paragraph will use
<em class="firstterm">UTF-8</em> as character encoding.

</p>
<p>

If you are installing at low priority, you will have the option
of selecting additional locales, including so-called <span class="quote">“<span class="quote">legacy</span>”</span>
locales<sup>[<a name="idp6414912" href="#ftn.idp6414912" class="footnote">10</a>]</sup>, to be generated for the installed system; if you do, you will
be asked which of the selected locales should be the default for the
installed system.

</p>
</div>
<div class="sect3" title="6.3.1.3.&nbsp;Choosing a Keyboard">
<div class="titlepage"><div><div><h4 class="title">
<a name="kbd-chooser"></a>6.3.1.3.&nbsp;Choosing a Keyboard</h4></div></div></div>
<p>

Keyboards are often tailored to the characters used in a language.
Select a layout that conforms to the keyboard you are using, or
select something close if the keyboard layout you want
isn't represented. Once the system installation is complete, you'll be
able to select a keyboard layout from a wider range of choices (run
<span class="command"><strong>dpkg-reconfigure keyboard-configuration</strong></span> as root after you have completed the
installation).

</p>
<p>

Move the highlight to the keyboard selection you desire and press
<span class="keycap"><strong>Enter</strong></span>.  Use the arrow keys to move the highlight — they are
in the same place in all national language keyboard layouts, so they
are independent of the keyboard configuration.

</p>
</div>
<div class="sect3" title="6.3.1.4.&nbsp;Looking for the Debian Installer ISO Image">
<div class="titlepage"><div><div><h4 class="title">
<a name="iso-scan"></a>6.3.1.4.&nbsp;Looking for the Debian Installer ISO Image</h4></div></div></div>
<p>

When installing via the <span class="emphasis"><em>hd-media</em></span> method, there
will be a moment where you need to find and mount the Debian Installer
iso image in order to get the rest of the installation files. The
component <span class="command"><strong>iso-scan</strong></span> does exactly this.

</p>
<p>

At first, <span class="command"><strong>iso-scan</strong></span> automatically mounts all block
devices (e.g. partitions) which have some known filesystem on them and
sequentially searches for filenames ending with
<code class="filename">.iso</code> (or <code class="filename">.ISO</code> for that
matter). Beware that the first attempt scans only files in the root
directory and in the first level of subdirectories (i.e. it finds
<code class="filename">/<em class="replaceable"><code>whatever</code></em>.iso</code>,
<code class="filename">/data/<em class="replaceable"><code>whatever</code></em>.iso</code>,
but not
<code class="filename">/data/tmp/<em class="replaceable"><code>whatever</code></em>.iso</code>).
After an iso image has been found, <span class="command"><strong>iso-scan</strong></span> checks
its content to determine if the image is a valid Debian iso image or
not. In the former case we are done, in the latter
<span class="command"><strong>iso-scan</strong></span> seeks for another image.

</p>
<p>

In case the previous attempt to find an installer iso image fails,
<span class="command"><strong>iso-scan</strong></span> will ask you whether you would like to
perform a more thorough search. This pass doesn't just look into the
topmost directories, but really traverses whole filesystem.

</p>
<p>

If <span class="command"><strong>iso-scan</strong></span> does not discover your installer iso
image, reboot back to your original operating system and check if the
image is named correctly (ending in <code class="filename">.iso</code>), if it is
placed on a filesystem recognizable by <code class="classname">debian-installer</code>, and if it is not
corrupted (verify the checksum). Experienced Unix users could do this
without rebooting on the second console.

</p>
</div>
<div class="sect3" title="6.3.1.5.&nbsp;Configuring the Network">
<div class="titlepage"><div><div><h4 class="title">
<a name="netcfg"></a>6.3.1.5.&nbsp;Configuring the Network</h4></div></div></div>
<p>

As you enter this step, if the system detects that you have more than
one network device, you'll be asked to choose which device will be
your <span class="emphasis"><em>primary</em></span> network interface, i.e. the one
which you want to use for installation. The other interfaces won't be
configured at this time. You may configure additional interfaces after
installation is complete; see the <span class="citerefentry"><span class="refentrytitle">interfaces</span>(5)</span> man page.

</p>
<div class="sect4" title="6.3.1.5.1.&nbsp;Automatic network configuration">
<div class="titlepage"><div><div><h5 class="title">
<a name="netcfg-automatic"></a>6.3.1.5.1.&nbsp;Automatic network configuration</h5></div></div></div>
<p>

By default, <code class="classname">debian-installer</code> tries to configure your computer's network
automatically as far as possible.  If the automatic configuration
fails, that may be caused by many factors ranging from an
unplugged network cable to missing infrastructure for automatic
configuration.  For further explanation in case of errors, check
the error messages on the fourth console.  In any case, you will
be asked if you want to retry, or if you want to perform a manual
setup.  Sometimes the network services used for autoconfiguration
can be slow in their responses, so if you are sure everything is
in place, simply start the autoconfiguration attempt again.
If autoconfiguration fails repeatedly, you can instead choose
the manual network setup.

</p>
</div>
<div class="sect4" title="6.3.1.5.2.&nbsp;Manual network configuration">
<div class="titlepage"><div><div><h5 class="title">
<a name="netcfg-manual"></a>6.3.1.5.2.&nbsp;Manual network configuration</h5></div></div></div>
<p>

The manual network setup in turn asks you a number of questions about
your network, notably
<code class="computeroutput">IP address</code>,
<code class="computeroutput">Netmask</code>,
<code class="computeroutput">Gateway</code>,
<code class="computeroutput">Name server addresses</code>, and a
<code class="computeroutput">Hostname</code>.
Moreover, if you have a wireless network interface, you will be asked
to provide your <code class="computeroutput">Wireless ESSID</code> 
(<span class="quote">“<span class="quote">wireless network name</span>”</span>) and a <code class="computeroutput">WEP key</code> or
<code class="computeroutput">WPA/WPA2 passphrase</code>.
Fill in the answers from
<a class="xref" href="http://www.debian.org/releases/stable/i386/ch03s03.html.en" title="3.3.&nbsp;Information You Will Need">Section&nbsp;3.3, “Information You Will Need”</a>.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Some technical details you might, or might not, find handy: the program
assumes the network IP address is the bitwise-AND of your system's IP
address and your netmask. The default broadcast address is calculated as
the bitwise OR of your system's IP address with the bitwise negation of
the netmask. It will also guess your gateway.  If you can't find any of
these answers, use the offered defaults — if necessary, you can
change them by editing <code class="filename">/etc/network/interfaces</code> once
the system has been installed.

</p>
</div>
</div>
<div class="sect4" title="6.3.1.5.3.&nbsp;IPv4 and IPv6">
<div class="titlepage"><div><div><h5 class="title">
<a name="netcfg-ipv4-ipv6"></a>6.3.1.5.3.&nbsp;IPv4 and IPv6</h5></div></div></div>
<p>

From Debian GNU/Linux 7.0 (<span class="quote">“<span class="quote">Wheezy</span>”</span>) onwards, <code class="classname">debian-installer</code> supports IPv6
as well as the <span class="quote">“<span class="quote">classic</span>”</span> IPv4. All combinations of IPv4 and
IPv6 (IPv4-only, IPv6-only and dual-stack configurations) are supported.

</p>
<p>

Autoconfiguration for IPv4 is done via DHCP (Dynamic Host Configuration
Protocol).  Autoconfiguration for IPv6 supports stateless autoconfiguration
using NDP (Neighbor Discovery Protocol, including recursive DNS server
(RDNSS) assignment), stateful autoconfiguration via DHCPv6 and mixed
stateless/stateful autoconfiguration (address configuration via NDP,
additional parameters via DHCPv6).

</p>
</div>
</div>
<div class="sect3" title="6.3.1.6.&nbsp;Configuring the Clock and Time Zone">
<div class="titlepage"><div><div><h4 class="title">
<a name="clock-setup"></a>6.3.1.6.&nbsp;Configuring the Clock and Time Zone</h4></div></div></div>
<p>

The installer will first attempt to connect to a time server on the
Internet (using the <em class="firstterm">NTP</em> protocol) in order to
correctly set the system time. If this does not succeed, the installer
will assume the time and date obtained from the system clock when the
installation system was booted are correct. It is not possible to manually
set the system time during the installation process.

</p>
<p>

Depending on the location selected earlier in the installation process,
you may be shown a list of time zones relevant for that location.
If your location has only one time zone and you are doing a default
installation, you will not be asked anything and the system will assume
that time zone.

</p>
<p>

In expert mode or when installing at medium priority, you will have the
additional option to select <span class="quote">“<span class="quote">Coordinated Universal Time</span>”</span> (UTC)
as time zone.

</p>
<p>

If for some reason you wish to set a time zone for the installed system
that does <span class="emphasis"><em>not</em></span> match the selected location, there are
two options.

</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
<p>

The simplest option is to just select a different time zone after the
installation has been completed and you've booted into the new system.
The command to do this is:

</p>
<div class="informalexample"><pre class="screen"># dpkg-reconfigure tzdata
</pre></div>
<p>

</p>
</li>
<li class="listitem"><p>

Alternatively, the time zone can be set at the very start of the
installation by passing the parameter
<strong class="userinput"><code>time/zone=<em class="replaceable"><code>value</code></em></code></strong>
when you boot the installation system. The value should of course be a
valid time zone, for example <strong class="userinput"><code>Europe/London</code></strong> or
<strong class="userinput"><code>UTC</code></strong>.

</p></li>
</ol></div>
<p>

For automated installations the time zone can be set to any desired value
using preseeding.

</p>
</div>
</div>
<div class="sect2" title="6.3.2.&nbsp;Setting Up Users And Passwords">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-user-setup"></a>6.3.2.&nbsp;Setting Up Users And Passwords</h3></div></div></div>
<p>

Just before configuring the clock, the installer will allow you
to set up the <span class="quote">“<span class="quote">root</span>”</span> account and/or an account for the first
user. Other user accounts can be created after the installation has been
completed.

</p>
<div class="sect3" title="6.3.2.1.&nbsp;Set the Root Password">
<div class="titlepage"><div><div><h4 class="title">
<a name="user-setup-root"></a>6.3.2.1.&nbsp;Set the Root Password</h4></div></div></div>
<p>

The <span class="emphasis"><em>root</em></span> account is also called the
<span class="emphasis"><em>super-user</em></span>; it is a login that bypasses all
security protection on your system. The root account should only be
used to perform system administration, and only used for as short
a time as possible.

</p>
<p>

Any password you create should contain at least 6 characters, and
should contain both upper- and lower-case characters, as well as
punctuation characters.  Take extra care when setting your root
password, since it is such a powerful account.  Avoid dictionary
words or use of any personal information which could be guessed.

</p>
<p>

If anyone ever tells you they need your root password, be extremely
wary. You should normally never give your root password out, unless you
are administering a machine with more than one system administrator.

</p>
</div>
<div class="sect3" title="6.3.2.2.&nbsp;Create an Ordinary User">
<div class="titlepage"><div><div><h4 class="title">
<a name="make-normal-user"></a>6.3.2.2.&nbsp;Create an Ordinary User</h4></div></div></div>
<p>

The system will ask you whether you wish to create an ordinary user
account at this point.  This account should be your main personal
log-in.  You should <span class="emphasis"><em>not</em></span> use the root account for
daily use or as your personal login.



</p>
<p>

Why not?  Well, one reason to avoid using root's privileges is that it
is very easy to do irreparable damage as root.  Another reason is that
you might be tricked into running a <span class="emphasis"><em>Trojan-horse</em></span>
program — that is a program that takes advantage of your
super-user powers to compromise the security of your system behind
your back. Any good book on Unix system administration will cover this
topic in more detail — consider reading one if it is new to you.

</p>
<p>

You will first be prompted for the user's full name. Then you'll be asked
for a name for the user account; generally your first name or something
similar will suffice and indeed will be the default. Finally, you will be
prompted for a password for this account.

</p>
<p>

If at any point after installation you would like to create another
account, use the <span class="command"><strong>adduser</strong></span> command.

</p>
</div>
</div>
<div class="sect2" title="6.3.3.&nbsp;Partitioning and Mount Point Selection">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-partition"></a>6.3.3.&nbsp;Partitioning and Mount Point Selection</h3></div></div></div>
<p>

At this time, after hardware detection has been executed a final time,
<code class="classname">debian-installer</code> should be at its full strength, customized for the user's needs
and ready to do some real work.

As the title of this section indicates, the main task of the next few
components lies in partitioning your disks, creating filesystems,
assigning mountpoints and optionally configuring closely related options
like RAID, LVM or encrypted devices.

</p>
<p>

If you are uncomfortable with partitioning, or just want to know more
details, see <a class="xref" href="http://www.debian.org/releases/stable/i386/apc.html.en" title="Appendix&nbsp;C.&nbsp;Partitioning for Debian">Appendix&nbsp;C, <i>Partitioning for Debian</i></a>.

</p>
<p>

First you will be given the opportunity to automatically partition
either an entire drive, or available free space on a drive. This is
also called <span class="quote">“<span class="quote">guided</span>”</span> partitioning. If you do not want to
autopartition, choose <span class="guimenuitem">Manual</span> from the menu.

</p>
<div class="sect3" title="6.3.3.1.&nbsp;Supported partitioning options">
<div class="titlepage"><div><div><h4 class="title">
<a name="partman-fs"></a>6.3.3.1.&nbsp;Supported partitioning options</h4></div></div></div>
<p>

The partitioner used in <code class="classname">debian-installer</code> is fairly versatile. It allows to create
many different partitioning schemes, using various partition tables,
file systems and advanced block devices.

</p>
<p>

Exactly which options are available depends mainly on the architecture,
but also on other factors. For example, on systems with limited internal
memory some options may not be available.
Defaults may vary as well. The type of partition table used by default
can for example be different for large capacity hard disks than for
smaller hard disks.
Some options can only be changed when installing at medium or low debconf
priority; at higher priorities sensible defaults will be used.

</p>
<p>

The installer supports various forms of advanced partitioning and use of
storage devices, which in many cases can be used in combination.

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
    <span class="emphasis"><em>Logical Volume Management (LVM)</em></span>
  </p></li>
<li class="listitem">
<p>
    <span class="emphasis"><em>Software RAID</em></span>
  </p>
<p>
    Supported are RAID levels 0, 1, 4, 5, 6 and 10.
  </p>
</li>
<li class="listitem"><p>
    <span class="emphasis"><em>Encryption</em></span>
  </p></li>
<li class="listitem">
<p>
    <span class="emphasis"><em>Serial ATA RAID</em></span> (using <code class="classname">dmraid</code>)
  </p>
<p>
    Also called <span class="quote">“<span class="quote">fake RAID</span>”</span> or <span class="quote">“<span class="quote">BIOS RAID</span>”</span>.
    Support for Serial ATA RAID is currently only available if enabled when
    the installer is booted. Further information is available on
    <a class="ulink" href="http://wiki.debian.org/DebianInstaller/SataRaid" target="_top">our Wiki</a>.
  </p>
</li>
<li class="listitem">
<p>
    <span class="emphasis"><em>Multipath</em></span> (experimental)
  </p>
<p>
    See <a class="ulink" href="http://wiki.debian.org/DebianInstaller/MultipathSupport" target="_top">our Wiki</a> for information.
    Support for multipath is currently only available if enabled when the
    installer is booted.
  </p>
</li>
</ul></div>
<p>

</p>
<p>

The following file systems are supported.

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<p>
    
    <span class="emphasis"><em>ext2</em></span>,
    <span><span class="emphasis"><em>ext3</em></span>,</span>
    <span><span class="emphasis"><em>ext4</em></span></span>
  </p>
<p>
    The default file system selected in most cases is ext4; for
    <code class="filename">/boot</code> partitions ext2 will be selected by default
    when guided partitioning is used.
  </p>
</li>
<li class="listitem"><p>
    <span class="emphasis"><em>jfs</em></span> (not available on all architectures)
  </p></li>
<li class="listitem"><p>
    <span class="emphasis"><em>xfs</em></span> (not available on all architectures)
  </p></li>
<li class="listitem">
<p>
    <span class="emphasis"><em>reiserfs</em></span> (optional; not available on all architectures)
  </p>
<p>
    Support for the Reiser file system is no longer available by default.
    When the installer is running at medium or low debconf priority it can
    be enabled by selecting the <code class="classname">partman-reiserfs</code>
    component. Only version 3 of the file system is supported.
  </p>
</li>
<li class="listitem">
<p>
    <span class="emphasis"><em>qnx4</em></span>
  </p>
<p>
    Existing partitions will be recognized and it is possible to assign
    mount points for them. It is not possible to create new qnx4 partitions.
  </p>
</li>
<li class="listitem"><p>
    <span class="emphasis"><em>FAT16</em></span>, <span class="emphasis"><em>FAT32</em></span>
  </p></li>
<li class="listitem">
<p>
    <span class="emphasis"><em>NTFS</em></span> (read-only)
  </p>
<p>
    Existing NTFS partitions can be resized and it is possible to assign
    mount points for them. It is not possible to create new NTFS partitions.
  </p>
</li>
</ul></div>
<p>

</p>
</div>
<div class="sect3" title="6.3.3.2.&nbsp;Guided Partitioning">
<div class="titlepage"><div><div><h4 class="title">
<a name="partman-auto"></a>6.3.3.2.&nbsp;Guided Partitioning</h4></div></div></div>
<p>

If you choose guided partitioning, you may have three options: to create
partitions directly on the hard disk (classic method), or to create them
using Logical Volume Management (LVM), or to create them using encrypted
LVM<sup>[<a name="idp6515152" href="#ftn.idp6515152" class="footnote">11</a>]</sup>.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

The option to use (encrypted) LVM may not be available on all architectures.

</p>
</div>
<p>

When using LVM or encrypted LVM, the installer will create most
partitions inside one big partition; the advantage of this method is that
partitions inside this big partition can be resized relatively easily later.
In the case of encrypted LVM the big partition will not be readable without
knowing a special key phrase, thus providing extra security of your
(personal) data.

</p>
<p>

When using encrypted LVM, the installer will also automatically erase the
disk by writing random data to it. This further improves security (as it
makes it impossible to tell which parts of the disk are in use and also
makes sure that any traces of previous installations are erased), but may
take some time depending on the size of your disk.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

If you choose guided partitioning using LVM or encrypted LVM, some changes
in the partition table will need to be written to the selected disk while
LVM is being set up. These changes effectively erase all data that is
currently on the selected hard disk and you will not be able to undo them
later. However, the installer will ask you to confirm these changes before
they are written to disk.

</p>
</div>
<p>

If you choose guided partitioning<span> (either classic or using (encrypted)
LVM)</span> for a whole disk, you will first be asked to select the disk you want
to use. Check that all your disks are listed and, if you have several disks,
make sure you select the correct one. The order they are listed in may
differ from what you are used to. The size of the disks may help to identify
them.

</p>
<p>

Any data on the disk you select will eventually be lost, but you will always
be asked to confirm any changes before they are written to the disk.
<span>
If you have selected the classic method of partitioning, you will be able to
undo any changes right until the end; when using (encrypted) LVM this is not
possible.
</span>

</p>
<p>

Next, you will be able to choose from the schemes listed in the table below.
All schemes have their pros and cons,
some of which are discussed in <a class="xref" href="http://www.debian.org/releases/stable/i386/apc.html.en" title="Appendix&nbsp;C.&nbsp;Partitioning for Debian">Appendix&nbsp;C, <i>Partitioning for Debian</i></a>. If you are
unsure, choose the first one. Bear in mind that guided partitioning
needs a certain minimal amount of free space to operate with. If you don't
give it at least about 1GB of space (depends on chosen scheme), guided
partitioning will fail.

</p>
<div class="informaltable"><table border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Partitioning scheme</th>
<th>Minimum space</th>
<th>Created partitions</th>
</tr></thead>
<tbody>
<tr>
<td>All files in one partition</td>
<td>600MB</td>
<td>
<code class="filename">/</code>, swap</td>
</tr>
<tr>
<td>Separate /home partition</td>
<td>500MB</td>
<td>
    <code class="filename">/</code>, <code class="filename">/home</code>, swap
  </td>
</tr>
<tr>
<td>Separate /home, /usr, /var and /tmp partitions</td>
<td>1GB</td>
<td>
    <code class="filename">/</code>, <code class="filename">/home</code>,
    <code class="filename">/usr</code>, <code class="filename">/var</code>,
    <code class="filename">/tmp</code>, swap
  </td>
</tr>
</tbody>
</table></div>
<p>

If you choose guided partitioning using (encrypted) LVM, the installer will also create
a separate <code class="filename">/boot</code> partition. The other partitions,
including the swap partition, will be created inside the LVM partition.

</p>
<p>

After selecting a scheme, the next screen will show your new partition
table, including information on whether and how partitions will be
formatted and where they will be mounted.

</p>
<p>

The list of partitions might look like this:

</p>
<div class="informalexample"><pre class="screen">  IDE1 master (hda) - 6.4 GB WDC AC36400L
        #1 primary   16.4 MB  B f ext2       /boot
        #2 primary  551.0 MB      swap       swap
        #3 primary    5.8 GB      ntfs
           pri/log    8.2 MB      FREE SPACE

  IDE1 slave (hdb) - 80.0 GB ST380021A
        #1 primary   15.9 MB      ext3
        #2 primary  996.0 MB      fat16
        #3 primary    3.9 GB      xfs        /home
        #5 logical    6.0 GB    f ext3       /
        #6 logical    1.0 GB    f ext3       /var
        #7 logical  498.8 MB      ext3
        #8 logical  551.5 MB      swap       swap
        #9 logical   65.8 GB      ext2
</pre></div>
<p>

This example shows two IDE harddrives divided into several partitions;
the first disk has some free space. Each partition line consists of the
partition number, its type, size, optional flags, file system, and
mountpoint (if any). Note: this particular setup cannot be created using
guided partitioning but it does show possible variation that can be achieved
using manual partitioning.

</p>
<p>

This concludes the guided partitioning. If you are satisfied with the
generated partition table, you can choose <span class="guimenuitem">Finish
partitioning and write changes to disk</span> from the menu to
implement the new partition table (as described at the end of this
section). If you are not happy, you can choose to <span class="guimenuitem">Undo
changes to partitions</span> and run guided partitioning again, or
modify the proposed changes as described below for manual partitioning.

</p>
</div>
<div class="sect3" title="6.3.3.3.&nbsp;Manual Partitioning">
<div class="titlepage"><div><div><h4 class="title">
<a name="partman-manual"></a>6.3.3.3.&nbsp;Manual Partitioning</h4></div></div></div>
<p>

A similar screen to the one shown just above will be displayed if you
choose manual partitioning except that your existing partition table will
be shown and without the mount points. How to manually set up your partition
table and the usage of partitions by your new Debian system will be covered
in the remainder of this section.

</p>
<p>

If you select a pristine disk which has neither partitions nor free
space on it, you will be asked if a new partition table should be
created (this is needed so you can create new partitions). After this,
a new line entitled <span class="quote">“<span class="quote">FREE SPACE</span>”</span> should appear in the table
under the selected disk.

</p>
<p>

If you select some free space, you will have the opportunity to create a
new partition. You will have to answer a quick series of questions about
its size, type (primary or logical), and location (beginning or end of
the free space). After this, you will be presented with a detailed
overview of your new partition. The main setting is <span class="guimenuitem">Use
as:</span>, which determines if the partition will have a file
system on it, or be used for swap,<span> software RAID, LVM, an encrypted
file system,</span> or not be used at all. Other settings include
mountpoint, mount options, and bootable flag; which settings are shown
depends on how the partition is to be used. If you don't like the
preselected defaults, feel free to change them to your liking. E.g. by
selecting the option <span class="guimenuitem">Use as:</span>, you can
choose a different filesystem for this partition, including options
to use the partition for swap,<span> software RAID, LVM,</span> or not
use it at all. Another nice feature is the ability to copy data from
an existing partition onto this one.
When you are satisfied with your new partition, select
<span class="guimenuitem">Done setting up the partition</span> and you will
return to <span class="command"><strong>partman</strong></span>'s main screen.

</p>
<p>

If you decide you want to change something about your partition,
simply select the partition, which will bring you to the partition
configuration menu. This is the same screen as is used when creating
a new partition, so you can change the same settings. One thing
that may not be very obvious at a first glance is that you can
resize the partition by selecting the item displaying the size of the
partition. Filesystems known to work are at least fat16, fat32, ext2,
ext3 and swap. This menu also allows you to delete a partition.

</p>
<p>

Be sure to create at least two partitions: one for the
<span class="emphasis"><em>root</em></span> filesystem (which must be mounted as
<code class="filename">/</code>) and one for <span class="emphasis"><em>swap</em></span>. If you
forget to mount the root filesystem, <span class="command"><strong>partman</strong></span> won't
let you continue until you correct this issue.

</p>
<p>

Capabilities of <span class="command"><strong>partman</strong></span> can be extended with installer
modules, but are dependent on your system's architecture. So if you can't
see all promised goodies, check if you have loaded all required modules
(e.g. <code class="filename">partman-ext3</code>, <code class="filename">partman-xfs</code>,
or <code class="filename">partman-lvm</code>).

</p>
<p>

After you are satisfied with partitioning, select <span class="guimenuitem">Finish
partitioning and write changes to disk</span> from the partitioning
menu. You will be presented with a summary of changes made to the disks
and asked to confirm that the filesystems should be created as requested.

</p>
</div>
<div class="sect3" title="6.3.3.4.&nbsp;Configuring Multidisk Devices (Software RAID)">
<div class="titlepage"><div><div><h4 class="title">
<a name="mdcfg"></a>6.3.3.4.&nbsp;Configuring Multidisk Devices (Software RAID)</h4></div></div></div>
<p>

If you have more than one harddrive<sup>[<a name="idp6561712" href="#ftn.idp6561712" class="footnote">12</a>]</sup> in your computer, you can use
<span class="command"><strong>mdcfg</strong></span> to set up your drives for increased
performance and/or better reliability of your data. The result is
called <em class="firstterm">Multidisk Device</em> (or after its most
famous variant <em class="firstterm">software RAID</em>).

</p>
<p>

MD is basically a bunch of partitions located on different disks and
combined together to form a <span class="emphasis"><em>logical</em></span> device. This
device can then be used like an ordinary partition (i.e. in
<span class="command"><strong>partman</strong></span> you can format it, assign a mountpoint,
etc.).

</p>
<p>

What benefits this brings depends on the type of MD device you are
creating. Currently supported are:

</p>
<div class="variablelist"><dl>
<dt><span class="term">RAID0</span></dt>
<dd>
<p>

Is mainly aimed at performance.  RAID0 splits all incoming data into
<em class="firstterm">stripes</em> and distributes them equally over each
disk in the array. This can increase the speed of read/write
operations, but when one of the disks fails, you will lose
<span class="emphasis"><em>everything</em></span> (part of the information is still on
the healthy disk(s), the other part <span class="emphasis"><em>was</em></span> on the
failed disk).

</p>
<p>

The typical use for RAID0 is a partition for video editing.

</p>
</dd>
<dt><span class="term">RAID1</span></dt>
<dd>
<p>

Is suitable for setups where reliability is the first concern.  It
consists of several (usually two) equally-sized partitions where every
partition contains exactly the same data. This essentially means three
things.  First, if one of your disks fails, you still have the data
mirrored on the remaining disks. Second, you can use only a fraction
of the available capacity (more precisely, it is the size of the
smallest partition in the RAID). Third, file-reads are load-balanced among
the disks, which can improve performance on a server, such as a file
server, that tends to be loaded with more disk reads than writes.

</p>
<p>

Optionally you can have a spare disk in the array which will take the
place of the failed disk in the case of failure.

</p>
</dd>
<dt><span class="term">RAID5</span></dt>
<dd>
<p>

Is a good compromise between speed, reliability and data redundancy.
RAID5 splits all incoming data into stripes and distributes them
equally on all but one disk (similar to RAID0). Unlike RAID0, RAID5
also computes <em class="firstterm">parity</em> information, which gets
written on the remaining disk. The parity disk is not static (that
would be called RAID4), but is changing periodically, so the parity
information is distributed equally on all disks.  When one of the
disks fails, the missing part of information can be computed from
remaining data and its parity. RAID5 must consist of at least three
active partitions. Optionally you can have a spare disk in the array
which will take the place of the failed disk in the case of failure.

</p>
<p>

As you can see, RAID5 has a similar degree of reliability to RAID1
while achieving less redundancy. On the other hand, it might be a bit
slower on write operations than RAID0 due to computation of parity
information.

</p>
</dd>
<dt><span class="term">RAID6</span></dt>
<dd>
<p>

Is similar to RAID5 except that it uses two parity devices instead of
one.

</p>
<p>

A RAID6 array can survive up to two disk failures.

</p>
</dd>
<dt><span class="term">RAID10</span></dt>
<dd>
<p>

RAID10 combines striping (as in RAID0) and mirroring (as in RAID1).
It creates <em class="replaceable"><code>n</code></em> copies of incoming data and
distributes them across the partitions so that none of the copies of
the same data are on the same device.
The default value of <em class="replaceable"><code>n</code></em> is 2, but it can be
set to something else in expert mode. The number of partitions used
must be at least <em class="replaceable"><code>n</code></em>.
RAID10 has different layouts for distributing the copies. The default is
near copies. Near copies have all of the copies at about the same offset
on all of the disks. Far copies have the copies at different offsets on
the disks. Offset copies copy the stripe, not the individual copies.

</p>
<p>

RAID10 can be used to achieve reliability and redundancy without the
drawback of having to calculate parity.

</p>
</dd>
</dl></div>
<p>

To sum it up:

</p>
<div class="informaltable"><table border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Type</th>
<th>Minimum Devices</th>
<th>Spare Device</th>
<th>Survives disk failure?</th>
<th>Available Space</th>
</tr></thead>
<tbody>
<tr>
<td>RAID0</td>
<td>2</td>
<td>no</td>
<td>no</td>
<td>Size of the smallest partition multiplied by number of devices in RAID</td>
</tr>
<tr>
<td>RAID1</td>
<td>2</td>
<td>optional</td>
<td>yes</td>
<td>Size of the smallest partition in RAID</td>
</tr>
<tr>
<td>RAID5</td>
<td>3</td>
<td>optional</td>
<td>yes</td>
<td>
    Size of the smallest partition multiplied by (number of devices in
    RAID minus one)
  </td>
</tr>
<tr>
<td>RAID6</td>
<td>4</td>
<td>optional</td>
<td>yes</td>
<td>
    Size of the smallest partition multiplied by (number of devices in
    RAID minus two)
  </td>
</tr>
<tr>
<td>RAID10</td>
<td>2</td>
<td>optional</td>
<td>yes</td>
<td>
    Total of all partitions divided by the number of chunk copies (defaults to two)
  </td>
</tr>
</tbody>
</table></div>
<p>

</p>
<p>

If you want to know more about Software RAID, have a look
at <a class="ulink" href="http://www.tldp.org/HOWTO/Software-RAID-HOWTO.html" target="_top">Software RAID HOWTO</a>.

</p>
<p>

To create an MD device, you need to have the desired partitions it
should consist of marked for use in a RAID.  (This is done in
<span class="command"><strong>partman</strong></span> in the <span class="guimenu">Partition
settings</span> menu where you should select <span class="guimenu">Use as:</span> → <span class="guimenuitem">physical volume for
RAID</span>.)

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Make sure that the system can be booted with the partitioning scheme
you are planning. In general it will be necessary to create a separate
file system for <code class="filename">/boot</code> when using RAID for the root
(<code class="filename">/</code>) file system.
Most boot loaders <span>(including lilo and grub)</span>
do support mirrored (not striped!) RAID1, so using for example RAID5 for
<code class="filename">/</code> and RAID1 for <code class="filename">/boot</code> can be
an option.

</p>
</div>
<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Warning</h3>
<p>

Support for MD is a relatively new addition to the installer.
You may experience problems for some RAID levels and in combination
with some bootloaders if you try to use MD for the root
(<code class="filename">/</code>) file system. For experienced users, it may be
possible to work around some of these problems by executing some
configuration or installation steps manually from a shell.

</p>
</div>
<p>

Next, you should choose <span class="guimenuitem">Configure software
RAID</span> from the main <span class="command"><strong>partman</strong></span> menu.
(The menu will only appear after you mark at least one partition for
use as <span class="guimenuitem">physical volume for RAID</span>.)
On the first screen of <span class="command"><strong>mdcfg</strong></span> simply select
<span class="guimenuitem">Create MD device</span>. You will be presented with
a list of supported types of MD devices, from which you should choose
one (e.g. RAID1). What follows depends on the type of MD you selected.
</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>

RAID0 is simple — you will be issued with the list of available
RAID partitions and your only task is to select the partitions which
will form the MD.

</p></li>
<li class="listitem"><p>

RAID1 is a bit more tricky. First, you will be asked to enter the
number of active devices and the number of spare devices which will
form the MD. Next, you need to select from the list of available RAID
partitions those that will be active and then those that will be
spare. The count of selected partitions must be equal to the number
provided earlier. Don't worry. If you make a mistake and
select a different number of partitions, <code class="classname">debian-installer</code> won't let you
continue until you correct the issue.

</p></li>
<li class="listitem"><p>

RAID5 has a setup procedure similar to RAID1 with the exception that you
need to use at least <span class="emphasis"><em>three</em></span> active partitions.

</p></li>
<li class="listitem"><p>

RAID6 also has a setup procedure similar to RAID1 except that at least
<span class="emphasis"><em>four</em></span> active partitions are required.

</p></li>
<li class="listitem"><p>

RAID10 again has a setup procedure similar to RAID1 except in expert
mode. In expert mode, <code class="classname">debian-installer</code> will ask you for the layout.
The layout has two parts. The first part is the layout type. It is either
<code class="literal">n</code> (for near copies), <code class="literal">f</code> (for far
copies), or <code class="literal">o</code> (for offset copies). The second part is
the number of copies to make of the data. There must be at least that
many active devices so that all of the copies can be distributed onto
different disks.

</p></li>
</ul></div>
<p>

It is perfectly possible to have several types of MD at once. For
example, if you have three 200 GB hard drives dedicated to MD, each
containing two 100 GB partitions, you can combine the first partitions on
all three disks into the RAID0 (fast 300 GB video editing partition)
and use the other three partitions (2 active and 1 spare) for RAID1
(quite reliable 100 GB partition for <code class="filename">/home</code>).

</p>
<p>

After you set up MD devices to your liking, you can
<span class="guimenuitem">Finish</span> <span class="command"><strong>mdcfg</strong></span> to return
back to the <span class="command"><strong>partman</strong></span> to create filesystems on your
new MD devices and assign them the usual attributes like mountpoints.

</p>
</div>
<div class="sect3" title="6.3.3.5.&nbsp;Configuring the Logical Volume Manager (LVM)">
<div class="titlepage"><div><div><h4 class="title">
<a name="partman-lvm"></a>6.3.3.5.&nbsp;Configuring the Logical Volume Manager (LVM)</h4></div></div></div>
<p>

If you are working with computers at the level of system administrator
or <span class="quote">“<span class="quote">advanced</span>”</span> user, you have surely seen the situation
where some disk partition (usually the most important one) was short on
space, while some other partition was grossly underused and you had to
manage this situation by moving stuff around, symlinking, etc.

</p>
<p>

To avoid the described situation you can use Logical Volume Manager
(LVM). Simply said, with LVM you can combine your partitions
(<em class="firstterm">physical volumes</em> in LVM lingo) to form
a virtual disk (so called <em class="firstterm">volume group</em>), which
can then be divided into virtual partitions (<em class="firstterm">logical
volumes</em>). The point is that logical volumes (and of course
underlying volume groups) can span across several physical disks.

</p>
<p>

Now when you realize you need more space for your old 160GB
<code class="filename">/home</code> partition, you can simply add a new 300GB
disk to the computer, join it with your existing volume group and then
resize the logical volume which holds your <code class="filename">/home</code>
filesystem and voila — your users have some room again on their
renewed 460GB partition.  This example is of course a bit
oversimplified. If you haven't read it yet, you should consult the
<a class="ulink" href="http://www.tldp.org/HOWTO/LVM-HOWTO.html" target="_top">LVM HOWTO</a>.

</p>
<p>

LVM setup in <code class="classname">debian-installer</code> is quite simple and completely supported inside
<span class="command"><strong>partman</strong></span>. First, you have to mark the partition(s)
to be used as physical volumes for LVM. This is done in the
<span class="guimenu">Partition settings</span> menu where you should select
<span class="guimenu">Use as:</span> → <span class="guimenuitem">physical volume
for LVM</span>.

</p>
<p>

When you return to the main <span class="command"><strong>partman</strong></span> screen, you will see
a new option <span class="guimenuitem">Configure the Logical Volume Manager</span>.
When you select that, you will first be asked to confirm pending changes to
the partition table (if any) and after that the LVM configuration menu will
be shown. Above the menu a summary of the LVM configuration is shown. The
menu itself is context sensitive and only shows valid actions. The possible
actions are:

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
    <span class="guimenuitem">Display configuration details</span>:
    shows LVM device structure, names and sizes of logical volumes and more
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Create volume group</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Create logical volume</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Delete volume group</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Delete logical volume</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Extend volume group</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Reduce volume group</span>
  </p></li>
<li class="listitem"><p>
    <span class="guimenuitem">Finish</span>:
    return to the main <span class="command"><strong>partman</strong></span> screen
  </p></li>
</ul></div>
<p>

</p>
<p>

Use the options in that menu to first create a volume group and then create
your logical volumes inside it.

</p>
<p>

After you return to the main <span class="command"><strong>partman</strong></span> screen, any created
logical volumes will be displayed in the same way as ordinary partitions
(and you should treat them as such).

</p>
</div>
<div class="sect3" title="6.3.3.6.&nbsp;Configuring Encrypted Volumes">
<div class="titlepage"><div><div><h4 class="title">
<a name="partman-crypto"></a>6.3.3.6.&nbsp;Configuring Encrypted Volumes</h4></div></div></div>
<p>

<code class="classname">debian-installer</code> allows you to set up encrypted partitions. Every file you write
to such a partition is immediately saved to the device in encrypted
form. Access to the encrypted data is granted only after entering
the <em class="firstterm">passphrase</em> used when the encrypted
partition was originally created. This feature is useful to protect
sensitive data in case your laptop or hard drive gets stolen. The
thief might get physical access to the hard drive, but without knowing
the right passphrase, the data on the hard drive will look like random
characters.

</p>
<p>

The two most important partitions to encrypt are: the home partition,
where your private data resides, and the swap partition, where
sensitive data might be stored temporarily during operation. Of
course, nothing prevents you from encrypting any other partitions that might
be of interest. For example <code class="filename">/var</code> where database
servers, mail servers or print servers store their data, or
<code class="filename">/tmp</code> which is used by various programs to store
potentially interesting temporary files. Some people may even want to
encrypt their whole system.  The only exception is
the <code class="filename">/boot</code> partition which must remain
unencrypted, because currently there is no way to load the kernel from
an encrypted partition.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Please note that the performance of encrypted partitions will be
less than that of unencrypted ones because the data needs to be
decrypted or encrypted for every read or write. The performance impact
depends on your CPU speed, chosen cipher and a key length.

</p>
</div>
<p>

To use encryption, you have to create a new partition by selecting
some free space in the main partitioning menu. Another option is to
choose an existing partition (e.g. a regular partition, an LVM logical
volume or a RAID volume). In the <span class="guimenu">Partition settings</span>
menu, you need to select <span class="guimenuitem">physical volume for
encryption</span> at the <span class="guimenu">Use
as:</span> option. The menu will then change to
include several cryptographic options for the partition.

</p>
<p>

<code class="classname">debian-installer</code> supports several encryption methods. The default method
is <em class="firstterm">dm-crypt</em> (included in newer Linux kernels,
able to host LVM physical volumes), the other
is <em class="firstterm">loop-AES</em> (older, maintained separately from
the Linux kernel tree). Unless you have compelling reasons to do
otherwise, it is recommended to use the default.



</p>
<p>

First, let's have a look at the options available when you select
<strong class="userinput"><code>Device-mapper (dm-crypt)</code></strong> as the encryption
method. As always: when in doubt, use the defaults, because
they have been carefully chosen with security in mind.

</p>
<div class="variablelist"><dl>
<dt><span class="term">Encryption: <strong class="userinput"><code>aes</code></strong></span></dt>
<dd><p>

This option lets you select the encryption algorithm
(<em class="firstterm">cipher</em>) which will be used to encrypt the data
on the partition. <code class="classname">debian-installer</code> currently supports the following block
ciphers: <em class="firstterm">aes</em>, <em class="firstterm">blowfish</em>,
<em class="firstterm">serpent</em>, and <em class="firstterm">twofish</em>.
It is beyond the scope of this document to discuss the qualities of
these different algorithms, however, it might help your decision to
know that in 2000, <span class="emphasis"><em>AES</em></span> was chosen by the American
National Institute of Standards and Technology as the standard
encryption algorithm for protecting sensitive information in the 21st
century.

</p></dd>
<dt><span class="term">Key size: <strong class="userinput"><code>256</code></strong></span></dt>
<dd><p>

Here you can specify the length of the encryption key. With a larger
key size, the strength of the encryption is generally improved. On the
other hand, increasing the length of the key usually has a negative
impact on performance. Available key sizes vary depending on the
cipher.

</p></dd>
<dt><span class="term">IV algorithm: <strong class="userinput"><code>cbc-essiv:sha256</code></strong></span></dt>
<dd>
<p>

The <em class="firstterm">Initialization Vector</em> or
<em class="firstterm">IV</em> algorithm is used in cryptography to ensure
that applying the cipher on the same <em class="firstterm">clear text</em>
data with the same key always produces a unique
<em class="firstterm">cipher text</em>. The idea is to prevent the
attacker from deducing information from repeated patterns in the encrypted
data.

</p>
<p>

From the provided alternatives, the default
<strong class="userinput"><code>cbc-essiv:sha256</code></strong> is currently the least
vulnerable to known attacks. Use the other alternatives only when you
need to ensure compatibility with some previously installed system
that is not able to use newer algorithms.

</p>
</dd>
<dt><span class="term">Encryption key: <strong class="userinput"><code>Passphrase</code></strong></span></dt>
<dd>
<p>

Here you can choose the type of the encryption key for this partition.

 </p>
<div class="variablelist"><dl>
<dt><span class="term">Passphrase</span></dt>
<dd><p>

The encryption key will be computed<sup>[<a name="idp6672256" href="#ftn.idp6672256" class="footnote">13</a>]</sup> on the basis of a passphrase which you will be able
to enter later in the process.

 </p></dd>
<dt><span class="term">Random key</span></dt>
<dd>
<p>

A new encryption key will be generated from random data each time you
try to bring up the encrypted partition.  In other words: on every
shutdown the content of the partition will be lost as the key is
deleted from memory. (Of course, you could try to guess the key with a
brute force attack, but unless there is an unknown weakness in the
cipher algorithm, it is not achievable in our lifetime.)

 </p>
<p>

Random keys are useful for swap partitions because you do not need to
bother yourself with remembering the passphrase or wiping sensitive
information from the swap partition before shutting down your
computer. However, it also means that you
will <span class="emphasis"><em>not</em></span> be able to use
the <span class="quote">“<span class="quote">suspend-to-disk</span>”</span> functionality offered by newer
Linux kernels as it will be impossible (during a subsequent boot) to
recover the suspended data written to the swap partition.

 </p>
</dd>
</dl></div>
<p>

</p>
</dd>
<dt><span class="term">Erase data: <strong class="userinput"><code>yes</code></strong></span></dt>
<dd><p>

Determines whether the content of this partition should be overwritten
with random data before setting up the encryption. This is recommended
because it might otherwise be possible for an attacker to discern
which parts of the partition are in use and which are not. In
addition, this will make it harder to recover any leftover data from
previous installations<sup>[<a name="idp6679440" href="#ftn.idp6679440" class="footnote">14</a>]</sup>.

</p></dd>
</dl></div>
<p>

</p>
<p>

If you select <span class="guimenu">Encryption method:</span> → <span class="guimenuitem">Loopback (loop-AES)</span>, the menu
changes to provide the following options:


</p>
<div class="variablelist"><dl>
<dt><span class="term">Encryption: <strong class="userinput"><code>AES256</code></strong></span></dt>
<dd><p>

For loop-AES, unlike dm-crypt, the options for cipher and key size are
combined, so you can select both at the same time.  Please see the
above sections on ciphers and key sizes for further information.

</p></dd>
<dt><span class="term">Encryption key: <strong class="userinput"><code>Keyfile (GnuPG)</code></strong></span></dt>
<dd>
<p>

Here you can select the type of the encryption key for this partition.

 </p>
<div class="variablelist"><dl>
<dt><span class="term">Keyfile (GnuPG)</span></dt>
<dd><p>

The encryption key will be generated from random data during the
installation. Moreover this key will be encrypted
with <span class="application">GnuPG</span>, so to use it, you will need to
enter the proper passphrase (you will be asked to provide one later in
the process).

 </p></dd>
<dt><span class="term">Random key</span></dt>
<dd><p>

Please see the section on random keys above.

 </p></dd>
</dl></div>
<p>

</p>
</dd>
<dt><span class="term">Erase data: <strong class="userinput"><code>yes</code></strong></span></dt>
<dd><p>

Please see the the section on erasing data above.

</p></dd>
</dl></div>
<p>

</p>
<p>

After you have selected the desired parameters for your encrypted
partitions, return back to the main partitioning menu. There should
now be a new menu item called <span class="guimenu">Configure encrypted
volumes</span>.  After you select it, you will be asked to confirm
the deletion of data on partitions marked to be erased and possibly
other actions such as writing a new partition table.  For large
partitions this might take some time.

</p>
<p>

Next you will be asked to enter a passphrase for partitions configured
to use one.  Good passphrases should be longer than 8 characters,
should be a mixture of letters, numbers and other characters and
should not contain common dictionary words or information easily
associable with you (such as birthdates, hobbies, pet names, names of
family members or relatives, etc.).

</p>
<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Warning</h3>
<p>

Before you input any passphrases, you should have made sure that your
keyboard is configured correctly and generates the expected
characters. If you are unsure, you can switch to the second virtual
console and type some text at the prompt. This ensures that you won't be
surprised later, e.g. by trying to input a passphrase using a qwerty 
keyboard layout when you used an azerty layout during the installation.
This situation can have several causes. Maybe you switched to another
keyboard layout during the installation, or the selected keyboard layout
might not have been set up yet when entering the passphrase for the
root file system.

</p>
</div>
<p>

If you selected to use methods other than a passphrase to create
encryption keys, they will be generated now. Because the kernel may
not have gathered a sufficient amount of entropy at this early stage
of the installation, the process may take a long time. You can help
speed up the process by generating entropy: e.g. by pressing random
keys, or by switching to the shell on the second virtual console and
generating some network and disk traffic (downloading some files,
feeding big files into <code class="filename">/dev/null</code>, etc.).



This will be repeated for each partition to be encrypted.

</p>
<p>

After returning to the main partitioning menu, you will see all
encrypted volumes as additional partitions which can be configured in
the same way as ordinary partitions. The following example shows two
different volumes. The first one is encrypted via dm-crypt, the second
one via loop-AES.

</p>
<div class="informalexample"><pre class="screen">Encrypted volume (<em class="replaceable"><code>sda2_crypt</code></em>) - 115.1 GB Linux device-mapper
     #1 115.1 GB  F ext3

Loopback (<em class="replaceable"><code>loop0</code></em>) - 515.2 MB AES256 keyfile
     #1 515.2 MB  F ext3
</pre></div>
<p>

Now is the time to assign mount points to the volumes and optionally
change the file system types if the defaults do not suit you.

</p>
<p>

Pay attention to the identifiers in parentheses
(<em class="replaceable"><code>sda2_crypt</code></em>
and <em class="replaceable"><code>loop0</code></em> in this case) and the mount
points you assigned to each encrypted volume. You will need this
information later when booting the new system. The differences between
the ordinary boot process and the boot process with encryption involved will
be covered later in <a class="xref" href="http://www.debian.org/releases/stable/i386/ch07s02.html.en" title="7.2.&nbsp;Mounting encrypted volumes">Section&nbsp;7.2, “Mounting encrypted volumes”</a>.

</p>
<p>

Once you are satisfied with the partitioning scheme, continue with the
installation.

</p>
</div>
</div>
<div class="sect2" title="6.3.4.&nbsp;Installing the Base System">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-install-base"></a>6.3.4.&nbsp;Installing the Base System</h3></div></div></div>
<p>

Although this stage is the least problematic, it consumes a significant
fraction of the install because it downloads, verifies and unpacks the whole
base system. If you have a slow computer or network connection, this could
take some time.

</p>
<p>

During installation of the base system, package unpacking and setup
messages are redirected to <strong class="userinput"><code>tty4</code></strong>.
You can access this terminal by pressing
<span class="keycap"><strong>Left Alt</strong></span>+<span class="keycap"><strong>F4</strong></span>;
get back to the main installer process with
<span class="keycap"><strong>Left Alt</strong></span>+<span class="keycap"><strong>F1</strong></span>.

</p>
<p>

The unpack/setup messages generated during this phase are also saved in
<code class="filename">/var/log/syslog</code>. You can check them there if the
installation is performed over a serial console.

</p>
<p>

As part of the installation, a Linux kernel will be installed. At the default
priority, the installer will choose one for you that best matches your
hardware. In lower priority modes, you will be able to choose from a list
of available kernels.

</p>
<p>

When packages are installed using the package management system, it will
by default also install packages that are recommended by those packages.
Recommended packages are not strictly required for the core functionality
of the selected software, but they do enhance that software and should,
in the view of the package maintainers, normally be installed together
with that software.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

For technical reasons packages installed during the installation of the
base system are installed without their <span class="quote">“<span class="quote">Recommends</span>”</span>. The
rule described above only takes effect after this point in the installation
process.

</p>
</div>
</div>
<div class="sect2" title="6.3.5.&nbsp;Installing Additional Software">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-install-software"></a>6.3.5.&nbsp;Installing Additional Software</h3></div></div></div>
<p>

At this point you have a usable but limited system.
Most users will want to install additional software on the system to tune it to
their needs, and the installer allows you do so. This step can take even
longer than installing the base system if you have a slow computer or
network connection.

</p>
<div class="sect3" title="6.3.5.1.&nbsp;Configuring apt">
<div class="titlepage"><div><div><h4 class="title">
<a name="apt-setup"></a>6.3.5.1.&nbsp;Configuring apt</h4></div></div></div>
<p>

One of the tools used to install packages on a Debian GNU/Linux system is
a program called <span class="command"><strong>apt-get</strong></span>, from the
<code class="classname">apt</code> package<sup>[<a name="idp6716496" href="#ftn.idp6716496" class="footnote">15</a>]</sup>.
Other front-ends for package management, like <span class="command"><strong>aptitude</strong></span>
and <span class="command"><strong>synaptic</strong></span>, are also in use.
These front-ends are recommended for new users, since they integrate
some additional features (package searching and status checks)
in a nice user interface. In fact, <span class="command"><strong>aptitude</strong></span> is now the
recommended utility for package management.

</p>
<p>

<span class="command"><strong>apt</strong></span> must be configured so that it knows from where to
retrieve packages. The results of this configuration are written to the
file <code class="filename">/etc/apt/sources.list</code>. You can examine and edit
this file to your liking after the installation is complete.

</p>
<p>

If you are installing at default priority, the installer will largely
take care of the configuration automatically, based on the installation
method you are using and possibly using choices made earlier in the
installation. In most cases the installer will automatically add a security
mirror and, if you are installing the stable distribution, a mirror for the
<span class="quote">“<span class="quote">volatile</span>”</span> update service.

</p>
<p>

If you are installing at a lower priority (e.g. in expert mode), you will
be able to make more decisions yourself. You can choose whether or not to
use the security and/or volatile update services, and you can choose to
add packages from the <span class="quote">“<span class="quote">contrib</span>”</span> and <span class="quote">“<span class="quote">non-free</span>”</span>
sections of the archive.

</p>
<div class="sect4" title="6.3.5.1.1.&nbsp;Installing from more than one CD or DVD">
<div class="titlepage"><div><div><h5 class="title">
<a name="apt-setup-cdset"></a>6.3.5.1.1.&nbsp;Installing from more than one CD or DVD</h5></div></div></div>
<p>

If you are installing from a CD or a DVD that is part of a larger set,
the installer will ask if you want to scan additional CDs or DVDs.
If you have additional CDs or DVDs available, you probably want to do
this so the installer can use the packages included on them.

</p>
<p>

If you do not have any additional CDs or DVDs, that is no problem: using
them is not required. If you also do not use a network mirror (as explained
in the next section), it can mean that not all packages belonging to the
tasks you select in the next step of the installation can be installed.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Packages are included on CDs (and DVDs) in the order of their popularity.
This means that for most uses only the first CDs in a set are needed and
that only very few people actually use any of the packages included on the
last CDs in a set.

</p>
<p>

It also means that buying or downloading and burning a full CD set is just
a waste of money as you'll never use most of them. In most cases you are
better off getting only the first 3 to 8 CDs and installing any additional
packages you may need from the Internet by using a mirror.
The same goes for DVD sets: the first DVD, or maybe the first two DVDs
will cover most needs.

</p>
<p>

A good rule of thumb is that for a regular desktop installation (using the
GNOME desktop environment) only the first three CDs are needed. For the
alternative desktop environments (KDE or Xfce), additional CDs are needed.
The first DVD easily covers all three desktop environments.

</p>
</div>
<p>

If you do scan multiple CDs or DVDs, the installer will prompt you to
exchange them when it needs packages from another CD/DVD than the one
currently in the drive. Note that only CDs or DVDs that belong to the
same set should be scanned. The order in which they are scanned does not
really matter, but scanning them in ascending order will reduce the chance
of mistakes.

</p>
</div>
<div class="sect4" title="6.3.5.1.2.&nbsp;Using a network mirror">
<div class="titlepage"><div><div><h5 class="title">
<a name="apt-setup-mirror"></a>6.3.5.1.2.&nbsp;Using a network mirror</h5></div></div></div>
<p>

One question that will be asked during most installs is whether or not to
use a network mirror as a source for packages. In most cases the default
answer should be fine, but there are some exceptions.

</p>
<p>

If you are <span class="emphasis"><em>not</em></span> installing from a full CD or DVD or
using a full CD/DVD image, you really should use a network mirror as
otherwise you will end up with only a very minimal system. However, if you
have a limited Internet connection it is best <span class="emphasis"><em>not</em></span>
to select the <code class="literal">desktop</code> task in the next step of the
installation.

</p>
<p>

If you are installing from a single full CD or using a full CD image, using
a network mirror is not required, but is still strongly recommended because
a single CD contains only a fairly limited number of packages.
If you have a limited Internet connection it may still be best
to <span class="emphasis"><em>not</em></span> select a network mirror here, but to finish the
installation using only what's available on the CD and selectively install
additional packages after the installation (i.e. after you have rebooted into
the new system).

</p>
<p>

If you are installing from a DVD or using a DVD image, any packages needed
during the installation should be present on the first DVD. The same is true
if you have scanned multiple CDs as explained in the previous section. Use
of a network mirror is optional.

</p>
<p>

One advantage of adding a network mirror is that updates that have occurred
since the CD/DVD set was created and have been included in a point release,
will become available for installation, thus extending the life of your CD/DVD
set without compromising the security or stability of the installed system.

</p>
<p>

In summary: selecting a network mirror is generally a good idea, except
if you do not have a good Internet connection. If the current version of
a package is available from CD/DVD, the installer will always use that.
The amount of data that will be downloaded if you do select a mirror thus
depends on

</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>

the tasks you select in the next step of the installation,

</p></li>
<li class="listitem"><p>

which packages are needed for those tasks,

</p></li>
<li class="listitem"><p>
 
which of those packages are present on the CDs or DVDs you have scanned, and

</p></li>
<li class="listitem"><p>

whether any updated versions of packages included on the CDs or DVDs are
available from a mirror (either a regular package mirror, or a mirror for
security or volatile updates).

</p></li>
</ol></div>
<p>

</p>
<p>

Note that the last point means that, even if you choose not to use a network
mirror, some packages may still be downloaded from the Internet if there is a
security or volatile update available for them and those services have been
configured.

</p>
</div>
<div class="sect4" title="6.3.5.1.3.&nbsp;Choosing a network mirror">
<div class="titlepage"><div><div><h5 class="title">
<a name="apt-setup-mirror-selection"></a>6.3.5.1.3.&nbsp;Choosing a network mirror</h5></div></div></div>
<p>

If you have selected to use a network mirror during the installation
(optional for CD/DVD installs, required for netboot images), you will be
presented with a list of geographically nearby (and therefore hopefully
fast) network mirrors, based upon your country selection earlier in the
installation process.  Choosing the offered default is usually fine.

</p>
<p>

A mirror can also be specified by hand by choosing <span class="quote">“<span class="quote">enter information
manually</span>”</span> . You can then specify a mirror host name and an optional
port number. As of Wheezy, that actually has to be a URL base, i.e. when
specifying an IPv6 address, one has to add square brackets around it, for
instance <span class="quote">“<span class="quote">[2001:db8::1]</span>”</span>.

</p>
<p>

If your computer is on an IPv6-only network (which is probably not the case
for the vast majority of users), using the default mirror for your country
might not work.  All the mirrors in the list are reachable via IPv4, but
only some of them can be used via IPv6.  As connectivity of individual
mirrors can change over time, this information is not available in the
installer.  If there is no IPv6 connectivity for the default mirror for your
country, you can either try some of the other mirrors offered to you or
choose the <span class="quote">“<span class="quote">enter information manually</span>”</span> option.  You can then specify
<span class="quote">“<span class="quote">ftp.ipv6.debian.org</span>”</span> as the mirror name, which is an alias for
a mirror available via IPv6, although it will probably not be the fastest
possible one.

</p>
<p>

Another option when choosing to specify the mirror manually is to use
<span class="quote">“<span class="quote">http.debian.net</span>”</span> as your mirror.
<span class="quote">“<span class="quote">http.debian.net</span>”</span> is not a physical mirror but a mirror
redirection service, i.e. it automatically refers your system to a
real mirror near you in terms of network topology. It takes into account
by which protocol you connect to it, i.e. if you use IPv6, it will
refer you to an IPv6-capable mirror near you.

</p>
</div>
</div>
<div class="sect3" title="6.3.5.2.&nbsp;Selecting and Installing Software">
<div class="titlepage"><div><div><h4 class="title">
<a name="pkgsel"></a>6.3.5.2.&nbsp;Selecting and Installing Software</h4></div></div></div>
<p>

During the installation process, you are given the opportunity to select
additional software to install. Rather than picking individual software
packages from the 
   
   
   <span>52118</span>
   
   
   
   
   
   
   
   
   
    available packages, this stage of
the installation process focuses on selecting and installing predefined
collections of software to quickly set up your computer to perform various
tasks.

</p>
<p>



So, you have the ability to choose <span class="emphasis"><em>tasks</em></span> first,
and then add on more individual packages later.  These tasks loosely
represent a number of different jobs or things you want to do with
your computer, such as <span class="quote">“<span class="quote">Desktop environment</span>”</span>,
<span class="quote">“<span class="quote">Web server</span>”</span>, or <span class="quote">“<span class="quote">Print server</span>”</span><sup>[<a name="idp6752224" href="#ftn.idp6752224" class="footnote">16</a>]</sup>. <a class="xref" href="http://www.debian.org/releases/stable/i386/apds02.html.en" title="D.2.&nbsp;Disk Space Needed for Tasks">Section&nbsp;D.2, “Disk Space Needed for Tasks”</a> lists the space
requirements for the available tasks.

</p>
<p>

Some tasks may be pre-selected based on the characteristics of the
computer you are installing. If you disagree with these selections you can
deselect them. You can even opt to install no tasks at all at this point.

</p>
<div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Tip</h3>
<p>

In the standard user interface of the installer, you can use the space bar
to toggle selection of a task.

</p>
</div>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Unless you are using the special KDE or Xfce/LXDE CDs, the <span class="quote">“<span class="quote">Desktop
environment</span>”</span> task will install the GNOME desktop environment.

</p>
<p>

It is not possible to interactively select a different desktop during
the installation. However, it <span class="emphasis"><em>is</em></span> possible to get <code class="classname">debian-installer</code>
to install a KDE desktop environment instead of GNOME by using preseeding
(see <a class="xref" href="http://www.debian.org/releases/stable/i386/apbs04.html.en#preseed-pkgsel" title="B.4.10.&nbsp;Package selection">Section&nbsp;B.4.10, “Package selection”</a>) or by adding the parameter
<code class="literal">desktop=kde</code> at the boot prompt when starting the
installer. Alternatively the more lightweight Xfce and LXDE desktop
environments can be selected by using <code class="literal">desktop=xfce</code> or
<code class="literal">desktop=lxde</code>.

</p>
<p>

Some CD images (netinst and DVD) also allow selection of
the desired desktop environment from the graphical boot menu. Select the
<span class="quote">“<span class="quote">Advanced options</span>”</span> option in the main menu and look for
<span class="quote">“<span class="quote">Alternative desktop environments</span>”</span>.

</p>
<p>

Note that this will only work if the packages needed for the desired
desktop environment
are actually available. If you are installing using a single full CD image,
they will need to be downloaded from a mirror as most needed packages are
only included on later CDs; installing KDE, Xfce or LXDE this way should work
fine if you are using a DVD image or any other installation method.

</p>
</div>
<p>

The various server tasks will install software roughly as follows.
DNS server: <code class="classname">bind9</code>;
File server: <code class="classname">samba</code>, <code class="classname">nfs</code>;
Mail server: <code class="classname">exim4</code>, <code class="classname">spamassassin</code>,
<code class="classname">uw-imap</code>;
Print server: <code class="classname">cups</code>;
SQL database: <code class="classname">postgresql</code>;
Web server: <code class="classname">apache2</code>.

</p>
<p>

The <span class="quote">“<span class="quote">Standard system</span>”</span> task will install any package that
has a priority <span class="quote">“<span class="quote">standard</span>”</span>. This includes a lot of common
utilities that are normally available on any Linux or Unix system. You
should leave this task selected unless you know what you are doing and
want a really minimal system.

</p>
<p>

If during language selection a default locale other than the <span class="quote">“<span class="quote">C</span>”</span>
locale was selected, <span class="command"><strong>tasksel</strong></span> will check if any
localization tasks are defined for that locale and will automatically try
to install relevant localization packages. This includes for example
packages containing word lists or special fonts for your language.
If a desktop environment was selected, it will also install appropriate
localization packages for that (if available).

</p>
<p>

Once you've selected your tasks, select <span class="guibutton">Continue</span>. At this point,
<span class="command"><strong>aptitude</strong></span> will install the packages that are part
of the selected tasks. If a particular program needs more information
from the user, it will prompt you during this process.

</p>
<p>

You should be aware that especially the Desktop task is very large.
Especially when installing from a normal CD-ROM in combination with a
mirror for packages not on the CD-ROM, the installer may want to retrieve
a lot of packages over the network. If you have a relatively slow
Internet connection, this can take a long time. There is no option to
cancel the installation of packages once it has started.

</p>
<p>

Even when packages are included on the CD-ROM, the installer may still
retrieve them from the mirror if the version available on the mirror is
more recent than the one included on the CD-ROM. If you are installing
the stable distribution, this can happen after a point release (an update
of the original stable release); if you are installing the testing
distribution this will happen if you are using an older image.

</p>
</div>
</div>
<div class="sect2" title="6.3.6.&nbsp;Making Your System Bootable">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-make-bootable"></a>6.3.6.&nbsp;Making Your System Bootable</h3></div></div></div>
<p>

If you are installing a diskless workstation, obviously, booting off
the local disk isn't a meaningful option, and this step will be
skipped. 

</p>
<div class="sect3" title="6.3.6.1.&nbsp;Detecting other operating systems">
<div class="titlepage"><div><div><h4 class="title">
<a name="os-prober"></a>6.3.6.1.&nbsp;Detecting other operating systems</h4></div></div></div>
<p>

Before a boot loader is installed, the installer will attempt to probe for
other operating systems which are installed on the machine. If it finds a
supported operating system, you will be informed of this during the boot
loader installation step, and the computer will be configured to boot this
other operating system in addition to Debian.

</p>
<p>

Note that multiple operating systems booting on a single machine is still
something of a black art. The automatic support for detecting and setting
up boot loaders to boot other operating systems varies by architecture and
even by subarchitecture. If it does not work you should consult your
boot manager's documentation for more information.



</p>
</div>
<div class="sect3" title="6.3.6.2.&nbsp;Install the Grub Boot Loader on a Hard Disk">
<div class="titlepage"><div><div><h4 class="title">
<a name="idp6781152"></a>6.3.6.2.&nbsp;Install the <span class="command"><strong>Grub</strong></span> Boot Loader
         on a Hard Disk</h4></div></div></div>
<p>

The main i386 boot loader is called <span class="quote">“<span class="quote">grub</span>”</span>.
Grub is a flexible and robust boot loader and a good default choice for
new users and old hands alike.

</p>
<p>

By default, grub will be installed into the Master Boot Record (MBR), where
it will take over complete control of the boot process. If you prefer, you
can install it elsewhere. See the grub manual for complete information.

</p>
<p>

If you do not want to install grub, use the <span class="guibutton">Go Back</span> button to get to the
main menu, and from there select whatever bootloader you would like to use.

</p>
</div>
<div class="sect3" title="6.3.6.3.&nbsp;Install the LILO Boot Loader on a Hard Disk">
<div class="titlepage"><div><div><h4 class="title">
<a name="idp6785840"></a>6.3.6.3.&nbsp;Install the <span class="command"><strong>LILO</strong></span> Boot Loader
         on a Hard Disk</h4></div></div></div>
<p>

The second i386 boot loader is called <span class="quote">“<span class="quote">LILO</span>”</span>.
It is an old complex program which offers lots of functionality,
including DOS, Windows, and OS/2 boot management.  Please carefully
read the instructions in the directory
<code class="filename">/usr/share/doc/lilo/</code> if you have special needs;
also see the <a class="ulink" href="http://www.tldp.org/HOWTO/LILO.html" target="_top">LILO mini-HOWTO</a>.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Currently the LILO installation will only create menu entries for other
operating systems if these can be <em class="firstterm">chainloaded</em>.
This means you may have to manually add a menu entry for operating
systems like GNU/Linux and GNU/Hurd after the installation.

</p>
</div>
<p>

<code class="classname">debian-installer</code> offers you three choices on where to install the
<span class="command"><strong>LILO</strong></span> boot loader:

</p>
<div class="variablelist"><dl>
<dt><span class="term">Master Boot Record (MBR)</span></dt>
<dd><p>

This way the <span class="command"><strong>LILO</strong></span> will take complete control of the
boot process.

</p></dd>
<dt><span class="term">new Debian partition</span></dt>
<dd><p>

Choose this if you want to use another boot
manager. <span class="command"><strong>LILO</strong></span> will install itself at the beginning
of the new Debian partition and it will serve as a secondary boot
loader.

</p></dd>
<dt><span class="term">Other choice</span></dt>
<dd><p>

Useful for advanced users who want to install <span class="command"><strong>LILO</strong></span>
somewhere else. In this case you will be asked for desired
location. You can use traditional device names such as
<code class="filename">/dev/hda</code> or <code class="filename">/dev/sda</code>.

</p></dd>
</dl></div>
<p>

</p>
<p>

If you can no longer boot into Windows 9x (or DOS) after this step,
you'll need to use a Windows 9x (MS-DOS) boot disk and use the
<strong class="userinput"><code>fdisk /mbr</code></strong> command to reinstall the MS-DOS
master boot record — however, this means that you'll need to use
some other way to get back into Debian!

</p>
</div>
<div class="sect3" title="6.3.6.4.&nbsp;Continue Without Boot Loader">
<div class="titlepage"><div><div><h4 class="title">
<a name="nobootloader"></a>6.3.6.4.&nbsp;Continue Without Boot Loader</h4></div></div></div>
<p>

This option can be used to complete the installation even when no boot
loader is to be installed, either because the arch/subarch doesn't
provide one, or because none is desired (e.g. you will use existing
boot loader).

</p>
<p>

If you plan to manually configure your bootloader, you should check the
name of the installed kernel in <code class="filename">/target/boot</code>.
You should also check that directory for the presence of an
<em class="firstterm">initrd</em>; if one is present, you will probably have
to instruct your bootloader to use it. Other information you will need
are the disk and partition you selected for your <code class="filename">/</code>
filesystem and, if you chose to install <code class="filename">/boot</code> on a
separate partition, also your <code class="filename">/boot</code> filesystem.

</p>
</div>
</div>
<div class="sect2" title="6.3.7.&nbsp;Finishing the Installation">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-finish"></a>6.3.7.&nbsp;Finishing the Installation</h3></div></div></div>
<p>

This is the last step in the Debian installation process during which the
installer will do any last minute tasks.
It mostly consists of tidying up after the <code class="classname">debian-installer</code>.

</p>
<div class="sect3" title="6.3.7.1.&nbsp;Setting the System Clock">
<div class="titlepage"><div><div><h4 class="title">
<a name="system-clock"></a>6.3.7.1.&nbsp;Setting the System Clock</h4></div></div></div>
<p>

The installer may ask you if the computer's clock is set to UTC. Normally
this question is avoided if possible and the installer tries to work out
whether the clock is set to UTC based on things like what other operating
systems are installed. 

</p>
<p>

In expert mode you will always be able to choose
whether or not the clock is set to UTC.

<span>Systems that (also) run Dos or Windows are normally
set to local time. If you want to dual-boot, select local time
instead of UTC.</span>

</p>
<p>

At this point <code class="classname">debian-installer</code> will also attempt to save the current time to the
system's hardware clock. This will be done either in UTC or local time,
depending on the selection that was just made.

</p>
</div>
<div class="sect3" title="6.3.7.2.&nbsp;Reboot the System">
<div class="titlepage"><div><div><h4 class="title">
<a name="finish-install"></a>6.3.7.2.&nbsp;Reboot the System</h4></div></div></div>
<p>

You will be prompted to remove the boot media (CD, floppy, etc) that you
used to boot the installer. After that the system will be rebooted into
your new Debian system.

</p>
</div>
</div>
<div class="sect2" title="6.3.8.&nbsp;Troubleshooting">
<div class="titlepage"><div><div><h3 class="title">
<a name="di-miscellaneous"></a>6.3.8.&nbsp;Troubleshooting</h3></div></div></div>
<p>

The components listed in this section are usually not involved in the
installation process, but are waiting in the background to help the
user in case something goes wrong.

</p>
<div class="sect3" title="6.3.8.1.&nbsp;Saving the installation logs">
<div class="titlepage"><div><div><h4 class="title">
<a name="save-logs"></a>6.3.8.1.&nbsp;Saving the installation logs</h4></div></div></div>
<p>

If the installation is successful, the logfiles created during
the installation process will be automatically saved to
<code class="filename">/var/log/installer/</code> on your new
Debian system.

</p>
<p>

Choosing <span class="guimenuitem">Save debug logs</span> from the main
menu allows you to save the log files to a floppy disk, network, hard
disk, or other media. This can be useful if you encounter fatal problems
during the installation and wish to study the logs on another system
or attach them to an installation report.

</p>
</div>
<div class="sect3" title="6.3.8.2.&nbsp;Using the Shell and Viewing the Logs">
<div class="titlepage"><div><div><h4 class="title">
<a name="shell"></a>6.3.8.2.&nbsp;Using the Shell and Viewing the Logs</h4></div></div></div>
<p>

There are several methods you can use to get a shell while running an
installation. On most systems, and if you are not installing over
serial console, the easiest method is to switch to the second
<span class="emphasis"><em>virtual console</em></span> by pressing <span class="keycap"><strong>Left
Alt</strong></span>+<span class="keycap"><strong>F2</strong></span><sup>[<a name="idp6832368" href="#ftn.idp6832368" class="footnote">17</a>]</sup> (on a Mac keyboard, <span class="keycap"><strong>Option</strong></span>+<span class="keycap"><strong>F2</strong></span>). Use <span class="keycap"><strong>Left Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> to switch back to the installer itself.

</p>
<p>

For the graphical installer see also <a class="xref" href="http://www.debian.org/releases/stable/i386/apds06.html.en#gtk-using" title="D.6.1.&nbsp;Using the graphical installer">Section&nbsp;D.6.1, “Using the graphical installer”</a>.

</p>
<p>

If you cannot switch consoles, there is also an <span class="guimenuitem">Execute
a Shell</span> item on the main menu that can be used to start
a shell. You can get to the main menu from most dialogs by using the 
<span class="guibutton">Go Back</span> button one or more times. Type <strong class="userinput"><code>exit</code></strong>
to close the shell and return to the installer.

</p>
<p>

At this point you are booted from the RAM disk, and there is a limited
set of Unix utilities available for your use. You can see what
programs are available with the command <span class="command"><strong>ls /bin /sbin /usr/bin
/usr/sbin</strong></span> and by typing <span class="command"><strong>help</strong></span>. 
The shell is a Bourne shell clone called <span class="command"><strong>ash</strong></span> and has
some nice features like autocompletion and history.

</p>
<p>

To edit and view files, use the text editor <span class="command"><strong>nano</strong></span>.
Log files for the installation system can be found in the
<code class="filename">/var/log</code> directory.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

Although you can do basically anything in a shell that the available
commands allow you to do, the option to use a shell is really only there
in case something goes wrong and for debugging.

</p>
<p>

Doing things manually from the shell may interfere with the installation
process and result in errors or an incomplete installation.
In particular, you should always use let the installer activate your swap
partition and not do this yourself from a shell.

</p>
</div>
</div>
</div>
<div class="sect2" title="6.3.9.&nbsp;Installation Over the Network">
<div class="titlepage"><div><div><h3 class="title">
<a name="network-console"></a>6.3.9.&nbsp;Installation Over the Network</h3></div></div></div>
<p>

One of the more interesting components is
<em class="firstterm">network-console</em>. It allows you to do a large
part of the installation over the network via SSH. The use of the
network implies you will have to perform the first steps of the
installation from the console, at least to the point of setting up
the networking. (Although you can automate that part with
<a class="xref" href="http://www.debian.org/releases/stable/i386/ch04s06.html.en" title="4.6.&nbsp;Automatic Installation">Section&nbsp;4.6, “Automatic Installation”</a>.)

</p>
<p>

This component is not loaded into the main installation menu by default,
so you have to explicitly ask for it.

If you are installing from CD, you need to boot with medium priority or
otherwise invoke the main installation menu and choose <span class="guimenuitem">Load
installer components from CD</span> and from the list of
additional components select <span class="guimenuitem">network-console: Continue
installation remotely using SSH</span>. Successful load is
indicated by a new menu entry called <span class="guimenuitem">Continue
installation remotely using SSH</span>.

</p>
<p>

<span>After selecting this new entry, you</span>
 will be asked for a new password
to be used for connecting to the installation system and for its
confirmation. That's all. Now you should see a screen which instructs
you to login remotely as the user <span class="emphasis"><em>installer</em></span> with
the password you just provided. Another important detail to notice on
this screen is the fingerprint of this system.  You need to transfer
the fingerprint securely to the person who will continue the
installation remotely.

</p>
<p>

Should you decide to continue with the installation locally, you
can always press <span class="keycap"><strong>Enter</strong></span>, which will bring you back to
the main menu, where you can select another component.

</p>
<p>

Now let's switch to the other side of the wire. As a prerequisite, you
need to configure your terminal for UTF-8 encoding, because that is
what the installation system uses. If you do not, remote installation
will be still possible, but you may encounter strange display
artefacts like destroyed dialog borders or unreadable non-ascii
characters. Establishing a connection with the installation system
is as simple as typing:

</p>
<div class="informalexample"><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>ssh -l installer <em class="replaceable"><code>install_host</code></em></code></strong>
</pre></div>
<p>

Where <em class="replaceable"><code>install_host</code></em> is either the name
or IP address of the computer being installed. Before the actual
login the fingerprint of the remote system will be displayed and
you will have to confirm that it is correct.

</p>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

The <span class="command"><strong>ssh</strong></span> server in the installer uses a default
configuration that does not send keep-alive packets. In principle,
a connection to the system being installed should be kept open
indefinitely. However, in some situations — depending on your
local network setup — the connection may be lost after some
period of inactivity. One common case where this can happen is when
there is some form of Network Address Translation (NAT) somewhere 
between the client and the system being installed. Depending on at
which point of the installation the connection was lost, you may or
may not be able to resume the installation after reconnecting.

</p>
<p>

You may be able to avoid the connection being dropped by adding the option
<strong class="userinput"><code>-o&nbsp;ServerAliveInterval=<em class="replaceable"><code>value</code></em></code></strong>
when starting the <span class="command"><strong>ssh</strong></span> connection, or by adding that
option in your <span class="command"><strong>ssh</strong></span> configuration file. Note however
that in some cases adding this option may also <span class="emphasis"><em>cause</em></span>
a connection to be dropped (for example if keep-alive packets are sent
during a brief network outage, from which <span class="command"><strong>ssh</strong></span> would
otherwise have recovered), so it should only be used when needed.

</p>
</div>
<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Note</h3>
<p>

If you install several computers in turn and they happen to have the
same IP address or hostname, <span class="command"><strong>ssh</strong></span> will refuse to connect
to such host. The reason is that it will have different fingerprint, which
is usually a sign of a spoofing attack. If you are sure this is not the
case, you will need to delete the relevant line from
<code class="filename">~/.ssh/known_hosts</code><sup>[<a name="idp6870928" href="#ftn.idp6870928" class="footnote">18</a>]</sup> and try again.

</p>
</div>
<p>

After the login you will be presented with an initial screen where you
have two possibilities called <span class="guimenuitem">Start menu</span> and
<span class="guimenuitem">Start shell</span>. The former brings you to the
main installer menu, where you can continue with the installation as
usual. The latter starts a shell from which you can examine and possibly
fix the remote system. You should only start one SSH session for the
installation menu, but may start multiple sessions for shells.

</p>
<div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Warning</h3>
<p>

After you have started the installation remotely over SSH, you should
not go back to the installation session running on the local console.
Doing so may corrupt the database that holds the configuration of
the new system. This in turn may result in a failed installation or
problems with the installed system.

</p>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.idp6408368" href="#idp6408368" class="para">8</a>] </sup>
In technical terms: where multiple locales exist for that language with
differing country codes.
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6412368" href="#idp6412368" class="para">9</a>] </sup>
At medium and low priority you can always select your preferred locale from
those available for the selected language (if there's more than one).
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6414912" href="#idp6414912" class="para">10</a>] </sup>
Legacy locales are locales which do not use UTF-8, but one of the older
standards for character encoding such as ISO&nbsp;8859-1 (used by West
European languages) or EUC-JP (used by Japanese).
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6515152" href="#idp6515152" class="para">11</a>] </sup>
The installer will encrypt the LVM volume group using a 256 bit AES key and
makes use of the kernel's <span class="quote">“<span class="quote">dm-crypt</span>”</span> support.
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6561712" href="#idp6561712" class="para">12</a>] </sup>

To be honest, you can construct an MD device even from partitions
residing on single physical drive, but that won't give any benefits.

</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6672256" href="#idp6672256" class="para">13</a>] </sup>

Using a passphrase as the key currently means that the partition will
be set up using <a class="ulink" href="http://code.google.com/p/cryptsetup/" target="_top">LUKS</a>.

</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6679440" href="#idp6679440" class="para">14</a>] </sup>

It is believed that the guys from three-letter agencies can restore
the data even after several rewrites of the magnetooptical media,
though.

</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6716496" href="#idp6716496" class="para">15</a>] </sup>
Note that the program which actually installs the packages is called
<span class="command"><strong>dpkg</strong></span>.  However, this program is more of a low-level
tool.  <span class="command"><strong>apt-get</strong></span> is a higher-level tool, which will
invoke <span class="command"><strong>dpkg</strong></span> as appropriate. It knows how to retrieve
packages from your CD, the network, or wherever. It is also able to
automatically install other packages which are required to make the
package you're trying to install work correctly.
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6752224" href="#idp6752224" class="para">16</a>] </sup>

You should know that to present this list, the installer is merely
invoking the <span class="command"><strong>tasksel</strong></span> program. It can be run at any
time after installation to install more packages (or remove them), or
you can use a more fine-grained tool such as <span class="command"><strong>aptitude</strong></span>.
If you are looking for a specific single package, after
installation is complete, simply run <strong class="userinput"><code>aptitude install
<em class="replaceable"><code>package</code></em></code></strong>, where
<em class="replaceable"><code>package</code></em> is the name of the package you are
looking for.

</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6832368" href="#idp6832368" class="para">17</a>] </sup>
That is: press the <span class="keycap"><strong>Alt</strong></span> key on the left-hand side of the
<span class="keycap"><strong>space bar</strong></span> and the <span class="keycap"><strong>F2</strong></span> function key
at the same time.
</p></div>
<div class="footnote"><p><sup>[<a id="ftn.idp6870928" href="#idp6870928" class="para">18</a>] </sup>
The following command will remove an existing entry for a host:
<span class="command"><strong>ssh-keygen -R &lt;<em class="replaceable"><code>hostname</code></em>|<em class="replaceable"><code>IP&nbsp;address</code></em>&gt;</strong></span>.
</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table summary="Navigation footer" width="100%">
<tbody><tr>
<td width="40%" align="left">
<a accesskey="p" href="http://www.debian.org/releases/stable/i386/ch06s02.html.en">Prev</a>&nbsp;</td>
<td width="20%" align="center"><a accesskey="u" href="http://www.debian.org/releases/stable/i386/ch06.html.en">Up</a></td>
<td width="40%" align="right">&nbsp;<a accesskey="n" href="http://www.debian.org/releases/stable/i386/ch06s04.html.en">Next</a>
</td>
</tr>
<tr>
<td valign="top" width="40%" align="left">6.2.&nbsp;Components Introduction&nbsp;</td>
<td width="20%" align="center"><a accesskey="h" href="http://www.debian.org/releases/stable/i386/index.html.en">Home</a></td>
<td valign="top" width="40%" align="right">&nbsp;6.4.&nbsp;Loading Missing Firmware</td>
</tr>
</tbody></table>
</div>


</body>
</html>
